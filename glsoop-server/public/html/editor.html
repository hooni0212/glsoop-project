<!DOCTYPE html>
<html lang="ko">
<head>
  <!--
    글 작성/수정 페이지(editor.html)
    - 연동 CSS: base.css, components.css, editor.css
    - 연동 JS: header.js(네비), editor.js(작성기 로직), utils.js(폰트/해시태그 유틸)
    - 핵심 요소: #editor-container(Quill), #hashtagInput/#hashtagChips(해시태그), #previewCard(미리보기)
  -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>글쓰기 | 글숲</title>

  <!-- Google Fonts: 사이트에서 사용할 한글 폰트들 로드 -->
  <link
    href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- Bootstrap CSS: 레이아웃/그리드/버튼 등 기본 스타일 -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- Quill CSS: 리치 텍스트 에디터 기본 테마(snow) -->
  <link
    href="https://cdn.quilljs.com/1.3.6/quill.snow.css"
    rel="stylesheet"
  />

  <!-- Custom CSS: 공통(main.css) + 글쓰기 전용(editor.css) -->
  <link rel="stylesheet" href="/css/app.css">
</head>
<body class="winter-theme page-editor">
  <!-- 상단 네비게이션 바 -->
  <nav class="navbar navbar-expand-lg navbar-dark custom-navbar fixed-top nav-height">
    <div class="gls-container">
      <!-- 로고: 클릭 시 메인(index.html)으로 이동 -->
      <a class="navbar-brand" href="/index.html">글숲</a>

      <!-- 모바일용 메뉴 토글 버튼 -->
      <button
        class="navbar-toggler"
        type="button"
        data-gls-toggle="nav" aria-controls="navbarNav" aria-expanded="false"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- 실제 네비게이션 메뉴 영역 -->
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav gls-me-lg-3 category-dropdown-nav">
          <li class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle"
              href="#"
              id="categoryDropdown"
              role="button"
              data-gls-toggle="dropdown"
              aria-expanded="false"
            >
              카테고리
            </a>
            <ul class="dropdown-menu nav-category-menu" aria-labelledby="categoryDropdown">
              <li><a class="dropdown-item nav-category-item" href="/explore">전체</a></li>
              <li>
                <a class="dropdown-item nav-category-item" href="/html/category.html?category=poem">시</a>
              </li>
              <li>
                <a class="dropdown-item nav-category-item" href="/html/category.html?category=essay">에세이/일기</a>
              </li>
              <li>
                <a class="dropdown-item nav-category-item" href="/html/category.html?category=short">짧은 구절</a>
              </li>
            </ul>
          </li>
        </ul>

        <!-- 로그인 전: 로그인 / 회원가입 메뉴 -->
        <ul class="navbar-nav gls-ms-auto before-login">
          <li class="nav-item">
            <a class="nav-link" href="/html/login.html">로그인</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/html/signup.html">회원가입</a>
          </li>
        </ul>

        <!-- 로그인 후: 이름 / 마이페이지 / 글쓰기 / 로그아웃 -->
        <!-- header.js에서 /api/me 결과에 따라 before-login/after-login 토글 -->
        <ul class="navbar-nav gls-ms-auto after-login" style="display: none;">
          <li class="nav-item">
            <!-- 로그인한 사용자 이름 표시 -->
            <span class="nav-link" id="navUserName"></span>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/html/mypage.html">마이페이지</a>
          </li>
          <li class="nav-item">
            <!-- 현재 페이지(글쓰기)로도 다시 올 수 있게 링크 유지 -->
            <a class="nav-link" href="/html/editor.html">글쓰기</a>
          </li>
          <li class="nav-item">
            <!-- 로그아웃 버튼 (header.js에서 이벤트 바인딩) -->
            <button
              class="user-profile"
              id="logoutBtn"
              type="button"
              aria-label="로그아웃"
            >
              <span class="user-profile-inner">
                <svg
                  aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                >
                  <g data-name="Layer 2" id="Layer_2">
                    <path
                      d="m15.626 11.769a6 6 0 1 0 -7.252 0 9.008 9.008 0 0 0 -5.374 8.231 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 9.008 9.008 0 0 0 -5.374-8.231zm-7.626-4.769a4 4 0 1 1 4 4 4 4 0 0 1 -4-4zm10 14h-12a1 1 0 0 1 -1-1 7 7 0 0 1 14 0 1 1 0 0 1 -1 1z"
                    ></path>
                  </g>
                </svg>
                <span class="user-profile-label">로그아웃</span>
              </span>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 본문 영역 -->
  <!-- fixed-top 네비게이션 때문에 gls-py-5 + gls-mt-5로 상단 여백 확보 -->
  <section class="gls-py-5 gls-mt-5">
    <div class="gls-container" style="max-width: 1100px;">

      <!-- 페이지 제목 + 간단 설명 -->
      <div class="gls-flex gls-flex-col gls-md-flex-row gls-justify-between gls-md-items-end gls-mb-4">
        <div>
          <h2 class="gls-mb-1">글쓰기</h2>
          <p class="gls-mb-0 gls-text-muted gls-text-small">
            오늘의 문장을 남기고, 오른쪽 카드에서 바로 피드 모습을 확인해 보세요.
          </p>
        </div>
      </div>

      <!-- 에디터 + 미리보기 영역 -->
      <!-- row: 왼쪽(입력/설정) + 오른쪽(미리보기) 두 컬럼 구조 -->
      <!-- align-items-stretch: 좌우 카드 높이 얼추 맞춰주기 -->
      <div class="editor-main-grid gls-gap-4">

        <!-- 📝 왼쪽: 제목 + 폰트 선택 + 에디터 + 해시태그 -->
        <!-- gls-flex gls-flex-col: 카드가 세로로 꽉 차도록 -->
        <div class="gls-flex gls-flex-col">
          <div class="card h-100">
            <div class="card-body">

              <!-- 상단: 제목 입력 + 폰트 선택 한 줄 정렬(데스크톱 기준) -->
              <div class="editor-top-grid gls-mb-3">
                <!-- 제목 입력 -->
                <div class="editor-top-grid__title">
                  <label for="postTitle" class="gls-label">제목</label>
                  <input
                    type="text"
                    id="postTitle"
                    class="gls-input"
                    placeholder="오늘의 글 제목을 입력하세요"
                  />
                </div>

                <!-- 폰트 선택 (select) -->
                <div class="editor-top-grid__font">
                  <label for="fontSelect" class="gls-label">폰트</label>
                  <select id="fontSelect" class="gls-select gls-select-sm">
                    <option value="serif">감성 명조체 (기본)</option>
                    <option value="sans">담백한 고딕체</option>
                    <option value="hand">손글씨 느낌</option>
                  </select>
                </div>

                <!-- 카테고리 선택 -->
                <div class="editor-top-grid__category">
                  <label for="categorySelect" class="gls-label">글 종류</label>
                  <select id="categorySelect" class="gls-select gls-select-sm" required>
                    <option value="" selected disabled>카테고리 선택</option>
                    <option value="poem">시</option>
                    <option value="essay">에세이/일기</option>
                    <option value="short">짧은 구절</option>
                  </select>
                </div>
              </div>

              <!-- 본문 에디터 + 글자 수 카운터 -->
              <div class="gls-mb-3 editor-wrapper gls-relative">
                <label class="gls-label">내용</label>
                <!-- Quill 에디터가 바인딩되는 div -->
                <div id="editor" class="editor-box" style="height: 260px;"></div>

                <!-- 에디터 박스 내부 오른쪽 아래에 표시될 글자 수 제한 안내 -->
                <div id="charCounter" class="char-counter gls-text-muted">
                  200/200
                </div>
              </div>

              <!-- 해시태그 입력 영역 + 저장 버튼 한 줄 배치 -->
              <div class="gls-mb-1">
                <div class="hashtag-save-grid">
                  <div class="hashtag-save-grid__input">
                    <label for="postHashtags" class="gls-label">해시태그</label>
                    <input
                      type="text"
                      id="postHashtags"
                      class="gls-input"
                      placeholder="#태그 입력 후 Enter로 추가"
                    />
                    <!-- 사용 예시 안내 -->
                    <div class="gls-form-help">
                      예) <code>#힐링 #밤산책 #공부기록</code> — 앞에 <code>#</code>를 붙이고 Enter를 눌러 해시태그를 추가하세요.
                    </div>
                  </div>
                  <div class="hashtag-save-grid__action gls-flex gls-md-justify-end">
                    <button id="saveBtn" class="gls-btn gls-btn-primary gls-save-btn gls-px-4 gls-mt-2 gls-md-mt-4">
                      저장하기
                    </button>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- 👀 오른쪽: 피드에서 보이는 모습 미리보기 -->
        <div class="gls-flex gls-flex-col">
          <!-- 상단 안내 카드 -->
          <div class="card gls-mb-3">
            <div class="card-body">
              <h4 class="card-title gls-mb-2">피드에서 보이는 모습 미리보기</h4>
              <p class="gls-text-muted gls-text-small gls-mb-0">
                홈 피드 카드에서 아래와 같이 보여요.
              </p>
            </div>
          </div>

          <!-- 실제 피드 카드 모양 미리보기 -->
          <!-- flex-grow-1: 남은 세로 공간을 채워서 아래쪽 카드가 크게 보이도록 -->
          <div class="card editor-preview-card gls-flex-1">
            <div class="card-body">
              <!-- 라벨(지금은 비워둠, 필요하면 안내 텍스트 추가 가능) -->
              <p class="gls-text-muted gls-text-small gls-mb-1"></p>

              <!-- 제목 미리보기: JS(editor.js)에서 실시간으로 변경 -->
              <h5 id="previewTitle" class="gls-mb-3">
                제목 미리보기
              </h5>

              <!-- 인스타 감성 종이질감 카드(quote-card) 안에 본문 미리보기 -->
              <div class="quote-card" id="previewContent">
                여기에 오늘의 문장을 적어 보시면, 이 카드에서 바로 미리 볼 수 있어요.
              </div>
              <button type="button" class="editor-preview-more" id="previewMoreBtn">
                더보기
              </button>
            </div>
          </div>
        </div>
        <!-- 오른쪽 끝 -->

      </div>

    </div>
  </section>

  <!-- JS 로드 순서 -->
  
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>
  <!-- 1) 공통 유틸 함수들 (escapeHtml, formatKoreanDateTime 등) -->
  <script src="/js/utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- 3) Quill 라이브러리 (리치 텍스트 에디터 동작) -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

  <!-- 4) 헤더 로그인 상태 처리 스크립트 -->
  <script src="../js/theme.js" defer></script>
  <script src="../js/header.js"></script>

  <!-- 5) 글쓰기 페이지 전용 스크립트(에디터 초기화, 글자 수 제한, 저장/수정 로직 등) -->
  <script src="../js/editor.js"></script>
</body>
</html>
