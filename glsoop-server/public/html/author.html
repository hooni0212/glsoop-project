<!DOCTYPE html>
<html lang="ko">
<head>
  <!--
    작가 페이지(author.html)
    - 연동 CSS: base.css, components.css, author.css
    - 연동 JS: header.js(네비), author.js(프로필/팔로우/무한스크롤), postCard.js(카드 공통)
    - 주요 요소: #authorProfileCard(왼쪽 프로필), #authorPosts(오른쪽 글 목록)
  -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>작가 페이지 | 글숲</title>

  <!-- Google Fonts: 사이트 전반에서 사용할 폰트들 로드 -->
  <link
    href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Nanum+Myeongjo:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- Bootstrap CSS: 레이아웃 및 기본 컴포넌트 스타일 -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

<link rel="stylesheet" href="/css/app.css">


</head>
<body class="page-author winter-theme">
  <!-- 상단 네비게이션 바 -->
  <nav class="navbar navbar-expand-lg navbar-dark custom-navbar fixed-top nav-height">
    <div class="gls-container">
      <!-- 로고: 클릭 시 메인 페이지로 이동 -->
      <a class="navbar-brand" href="/index.html">글숲</a>

      <!-- 모바일에서 메뉴를 접었다 펼치는 토글 버튼 -->
      <button
        class="navbar-toggler"
        type="button"
        data-gls-toggle="nav" aria-controls="navbarNav" aria-expanded="false"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- 실제 네비게이션 메뉴 영역 -->
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav gls-me-lg-3 category-dropdown-nav">
          <li class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle"
              href="#"
              id="categoryDropdown"
              role="button"
              data-gls-toggle="dropdown"
              aria-expanded="false"
            >
              카테고리
            </a>
            <ul class="dropdown-menu nav-category-menu" aria-labelledby="categoryDropdown">
              <li><a class="dropdown-item nav-category-item" href="/explore">전체</a></li>
              <li><a class="dropdown-item nav-category-item" href="/html/category.html?category=poem">시</a></li>
              <li><a class="dropdown-item nav-category-item" href="/html/category.html?category=essay">에세이/일기</a></li>
              <li><a class="dropdown-item nav-category-item" href="/html/category.html?category=short">짧은 구절</a></li>
            </ul>
          </li>
        </ul>

        <!-- 로그인 전: 로그인 / 회원가입 메뉴 -->
        <ul class="navbar-nav gls-ms-auto before-login">
          <li class="nav-item">
            <a class="nav-link" href="/html/login.html">로그인</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/html/signup.html">회원가입</a>
          </li>
        </ul>

        <!-- 로그인 후: 사용자 이름 / 마이페이지 / 글쓰기 / 로그아웃 -->
        <!-- 기본은 display:none; → header.js에서 /api/me 결과에 따라 토글 -->
        <ul class="navbar-nav gls-ms-auto after-login" style="display: none;">
          <li class="nav-item">
            <!-- 로그인한 사용자 이름 표시 -->
            <span class="nav-link" id="navUserName"></span>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/html/mypage.html">마이페이지</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/html/editor.html">글쓰기</a>
          </li>
          <li class="nav-item">
            <!-- 로그아웃 버튼 (header.js에서 이벤트 바인딩) -->
            <button
              class="user-profile"
              id="logoutBtn"
              type="button"
              aria-label="로그아웃"
            >
              <span class="user-profile-inner">
                <svg
                  aria-hidden="true"
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                >
                  <g data-name="Layer 2" id="Layer_2">
                    <path
                      d="m15.626 11.769a6 6 0 1 0 -7.252 0 9.008 9.008 0 0 0 -5.374 8.231 3 3 0 0 0 3 3h12a3 3 0 0 0 3-3 9.008 9.008 0 0 0 -5.374-8.231zm-7.626-4.769a4 4 0 1 1 4 4 4 4 0 0 1 -4-4zm10 14h-12a1 1 0 0 1 -1-1 7 7 0 0 1 14 0 1 1 0 0 1 -1 1z"
                    ></path>
                  </g>
                </svg>
                <span class="user-profile-label">로그아웃</span>
              </span>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- 작가 페이지 본문 -->
  <!-- fixed-top 네비게이션 때문에 gls-py-5 + gls-mt-5로 상단 여백 확보 -->
  <section class="author-page-section">
    <div class="author-page-shell">
      <!-- 페이지 상단 타이틀/설명 -->
      <div class="author-page-header">
        <!-- JS에서 닉네임 불러와 “OOO님의 나무” 등으로 바뀜 -->
        <h2 id="authorPageTitle" class="gls-mb-1">작가님의 글숲</h2>
        <p class="gls-mb-0 gls-text-muted gls-text-small">
          이 작가가 남긴 글들과 공감 기록을 한 눈에 볼 수 있어요.
        </p>
      </div>

      <!-- 메인 레이아웃: 왼쪽 프로필 카드 + 오른쪽 글 목록 -->
      <div class="author-page-main-row gls-items-start">
        <!-- 왼쪽: 작가 정보 카드 -->
        <aside class="author-left-col">
          <div class="card author-profile-card gls-surface-panel gls-surface-veil">
            <div class="card-body gls-flex gls-flex-col">
              <div class="author-card-header">
                <span class="author-card-title">작가 정보</span>
              </div>

              <div class="author-identity-block">
                <div class="gls-user-badge">
                  <div class="gls-user-badge__avatar" id="authorAvatarInitial" aria-hidden="true">
                    🌿
                  </div>
                  <div class="gls-user-badge__body">
                    <p class="gls-user-badge__name gls-mb-1" id="authorNicknameDisplay">닉네임</p>
                    <div id="authorEmailDisplay" class="gls-user-badge__sub" aria-live="polite">-</div>
                    <p class="gls-user-badge__chip gls-text-small gls-mb-1" id="authorGrowthBadge">Lv.1 🌰 씨앗</p>
                  </div>
                </div>
              </div>

              <div class="author-bio-block">
                <p class="author-label gls-text-small gls-mb-1">한 줄 소개</p>
                <p id="authorBio" class="author-bio-text gls-mb-3 gls-text-muted">
                  <!-- 한 줄 소개 -->
                </p>
                <p class="author-label gls-text-small gls-mb-1">작가 소개</p>
                <p id="authorAbout" class="author-about-text gls-mb-0">
                  <!-- 자기소개 여러 줄 -->
                </p>
              </div>

              <div class="author-stats-card">
                <div class="author-label gls-text-small gls-mb-2">작가 활동 요약</div>
                <div class="author-stats-grid">
                  <div class="author-stat">
                    <span class="label">작성한 글 수</span>
                    <span class="value" id="authorPostCount">0</span>
                  </div>
                  <div class="author-stat">
                    <span class="label">받은 공감 수</span>
                    <span class="value" id="authorLikeCount">0</span>
                  </div>
                  <div class="author-stat">
                    <span class="label">팔로워</span>
                    <span class="value" id="authorFollowerCount">0</span>
                  </div>
                  <div class="author-stat">
                    <span class="label">팔로잉</span>
                    <span class="value" id="authorFollowingCount">0</span>
                  </div>
                </div>
              </div>

              <div class="author-follow-block mt-auto">
                <button
                  id="authorFollowBtn"
                  type="button"
                  class="gls-btn gls-btn-secondary gls-btn-block"
                  aria-live="polite"
                >
                  팔로우
                </button>
                <p class="gls-text-muted gls-text-small gls-mb-0 gls-mt-2" id="authorFollowHint">
                  홈 피드에서 이 작가의 카드를 눌러도 이 페이지로 다시 올 수 있어요.
                </p>
              </div>
            </div>
          </div>
        </aside>

        <!-- 오른쪽: 작가의 글 목록 카드 -->
        <div class="author-right-col">
          <div class="author-feed-toolbar">
            <div class="author-feed-toolbar-text">
              <h4 class="gls-mb-1">이 작가의 글</h4>
              <p class="gls-text-muted gls-text-small gls-mb-0">
                작가가 남긴 문장과 공감이 모이는 공간이에요.
              </p>
            </div>
            <div class="author-feed-toolbar-actions">
              <button
                type="button"
                class="gls-action-pill"
                id="authorShareBtn"
                aria-label="작가 페이지 공유"
              >
                공유
              </button>
              <button
                type="button"
                class="gls-action-pill"
                id="authorSortBtn"
                data-gls-toggle="modal"
                data-gls-target="#authorSortModal"
                aria-label="정렬 방식 선택"
              >
                정렬
              </button>
              <a
                href="/html/mypage.html"
                class="gls-action-pill author-profile-action gls-hidden"
                id="authorProfileActionBtn"
                aria-label="내 프로필로 이동"
              >
                내 프로필
              </a>
            </div>
          </div>

          <!-- 데스크톱에서만 보이는 스크롤 안내 텍스트 -->
          <p class="gls-text-muted gls-text-small gls-mb-3 gls-hidden gls-md-block">
            아래로 스크롤하면 더 많은 글을 볼 수 있어요.
          </p>

          <!-- 글 목록 카드(안에 무한 스크롤로 글들이 쌓임) -->
          <div class="author-posts-card gls-surface-panel gls-surface-veil">
            <div class="author-posts-card-body">
              <!-- 실제 글 카드들이 JS로 렌더링 되는 영역 -->
              <div id="authorPostsList"></div>

              <!-- 글 로딩 중 메시지 -->
              <div
                id="authorPostsLoading"
                class="gls-text-center gls-text-muted gls-text-small gls-py-3"
                style="display: none;"
              >
                글을 불러오는 중입니다...
              </div>

              <!-- 이 작가가 글을 한 편도 쓰지 않았을 때 -->
              <div
                id="authorPostsEmpty"
                class="gls-text-center gls-text-muted gls-text-small gls-py-5"
                style="display: none;"
              >
                아직 이 작가가 남긴 글이 없습니다.
              </div>

              <!-- 더 불러올 글이 없을 때(마지막까지 내려왔을 때) -->
              <div
                id="authorPostsEnd"
                class="gls-text-center gls-text-muted gls-text-small gls-py-3"
                style="display: none;"
              >
                마지막 글까지 다 보셨어요.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 정렬 모달 -->
  <div
    class="modal fade"
    id="authorSortModal"
    tabindex="-1"
    aria-labelledby="authorSortModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="authorSortModalLabel">정렬</h5>
          <button
            type="button"
            class="gls-modal-close"
            data-gls-dismiss="modal"
            aria-label="닫기"
          ></button>
        </div>
        <div class="modal-body">
          <div class="gls-modal-section">
            <p class="gls-text-muted gls-text-small gls-mb-3">
              보고 싶은 순서를 선택하면 글 목록이 새로 정렬됩니다.
            </p>
            <div class="author-sort-options" role="radiogroup" aria-label="정렬 선택">
              <label class="author-sort-option">
                <input type="radio" name="authorSort" value="newest" checked />
                <span>최신순</span>
              </label>
              <label class="author-sort-option">
                <input type="radio" name="authorSort" value="oldest" />
                <span>오래된순</span>
              </label>
              <label class="author-sort-option">
                <input type="radio" name="authorSort" value="likes" />
                <span>공감 많은순</span>
              </label>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="gls-btn gls-btn-secondary" data-gls-dismiss="modal">
            닫기
          </button>
        </div>
      </div>
    </div>
  </div>

  <div id="authorToast" class="author-toast" role="status" aria-live="polite"></div>

  <!-- 푸터 -->
  <!-- 이 페이지는 사이트 공통 custom-footer 대신, author 전용 라이트한 푸터 사용 -->
  <footer class="site-footer gls-mt-5 gls-py-4">
    <div class="gls-container gls-text-center gls-text-muted gls-text-small">
      © 2025 글숲 · 오늘의 문장을 천천히 적어 내려가요.
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/dompurify@3/dist/purify.min.js"></script>

  <!-- 공통 유틸 스크립트 (escapeHtml, formatKoreanDateTime, maskEmail 등) -->
  <script src="/js/utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- 헤더 로그인 상태/로그아웃 버튼 처리 -->
  <script src="/js/seasonal.js" defer></script>
  <script src="../js/theme.js" defer></script>
  <script src="../js/header.js"></script>

  <!-- 작가 페이지 전용 스크립트: 프로필/글 목록 로딩 & 무한 스크롤 -->
  <script src="../js/author.js"></script>
</body>
</html>
